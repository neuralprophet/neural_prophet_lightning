<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Future Regressors - NeuralProphet</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Future Regressors";
    var mkdocs_page_input_path = "model/future-regressors.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> NeuralProphet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">NeuralProphet</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Quickstart</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../model-overview/">Model Overview</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Model Components</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../trend/">Trend</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../seasonality/">Seasonality</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../auto-regression/">Auto-Regression</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lagged-regressors/">Lagged Regressors</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../events/">Events</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Future Regressors</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#additive-future-regressors">Additive Future Regressors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#multiplicative-future-regressors">Multiplicative Future Regressors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#regularization-for-future-regressors">Regularization for Future Regressors</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">About</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../contribute/">Contribute</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">NeuralProphet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Model Components &raquo;</li>
        
      
    
    <li>Future Regressors</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="modelling-future-regressors">Modelling Future Regressors</h1>
<p>Future regressors are the external variables which have known future values. In that sense, the
future regressors functionality if very similar to special events.</p>
<p>The past values of these regressors corresponding to the training time stamps, have to be provided along
with the training data itself. See below for an example where we create two dummy regressors <code>A</code> and <code>B</code> by 
taking rolling means of the original data.</p>
<pre><code class="language-python">df['A'] = df['y'].rolling(7, min_periods=1).mean()
df['B'] = df['y'].rolling(30, min_periods=1).mean()

</code></pre>
<p>The dataframe created likewise, should look like below.</p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">ds</th>
<th align="right">y</th>
<th align="right">A</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">2007-12-10</td>
<td align="right">9.59076</td>
<td align="right">9.59076</td>
<td align="right">9.59076</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">2007-12-11</td>
<td align="right">8.51959</td>
<td align="right">9.05518</td>
<td align="right">9.05518</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">2007-12-12</td>
<td align="right">8.18368</td>
<td align="right">8.76468</td>
<td align="right">8.76468</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">2007-12-13</td>
<td align="right">8.07247</td>
<td align="right">8.59162</td>
<td align="right">8.59162</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">2007-12-14</td>
<td align="right">7.89357</td>
<td align="right">8.45201</td>
<td align="right">8.45201</td>
</tr>
</tbody>
</table>
<p>In order to perform forecasting, we also need to provide the future values of the regressors. </p>
<pre><code class="language-python">future_regressors_df = pd.DataFrame(data={'A': df['A'][:50], 'B': df['B'][:50]})
</code></pre>
<p>This dataframe looks like below.</p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="right">A</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="right">9.59076</td>
<td align="right">9.59076</td>
</tr>
<tr>
<td align="right">1</td>
<td align="right">9.05518</td>
<td align="right">9.05518</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">8.76468</td>
<td align="right">8.76468</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">8.59162</td>
<td align="right">8.59162</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">8.45201</td>
<td align="right">8.45201</td>
</tr>
</tbody>
</table>
<p>It is a dataframe with only the columns of the future values of the regressors.</p>
<p>Similar to events, future regressors too can be added in both the additive and multiplicative formats.</p>
<h2 id="additive-future-regressors">Additive Future Regressors</h2>
<p>The default mode for future regressors in <code>neural_prophet</code> is additive. The regressors have to be added to
the <code>NeuralProphet</code> object by calling the <code>add_future_regressor</code> function. Once this is done, the model can be
fitted by providing to the <code>fit</code> function, the dataframe of the training data as well as the regressor values.</p>
<pre><code class="language-python">m = NeuralProphet(
        n_forecasts=3,
        n_lags=5,
    )

m = m.add_future_regressor(name='A')
m = m.add_future_regressor(name='B')

metrics = m.fit(df)
</code></pre>
<p>When forecasting, the future dataframe must be created by providing the future values
of the regressors. To do that, now you need to call the <code>make_future_dataframe</code> function
by providing the previously created <code>future_regressors_df</code> as an argument.</p>
<pre><code class="language-python">future = m.make_future_dataframe(df=df, regressors_df=future_regressors_df, future_periods=3)
forecast = m.predict(df=future)
</code></pre>
<p>Now you can plot the components the same way and the resulting plot would look something
like below.</p>
<pre><code class="language-python">fig_comp = m.plot_components(forecast)
</code></pre>
<p><img alt="plot-comp-1" src="../../images/plot_comp_future_reg_1.png" style="height:850px;width:500px" /></p>
<p>In addition to the components like seasonality, auto-regression and trend it also shows
a plot for the additive future regressors. The coefficients of the future regressors can also be plotted.</p>
<pre><code class="language-python">fig_param = m.plot_parameters()
</code></pre>
<p><img alt="plot-param-1" src="../../images/plot_param_future_reg_1.png" style="height:850px;width:500px" /></p>
<h2 id="multiplicative-future-regressors">Multiplicative Future Regressors</h2>
<p>Future regressors can also be added in multiplicative mode. You simply need to set 
the mode to <code>multiplicative</code> when adding the regressors to the <code>NeuralProphet</code> object.</p>
<pre><code class="language-python">m = m.add_future_regressor(name='A', mode=&quot;multiplicative&quot;)
m = m.add_future_regressor(name='B')
</code></pre>
<p>In the above example, we have both additive and multiplicative regressors, where <code>A</code>
is multiplicative and <code>B</code> is additive. All the other steps in the fitting and the forecasting
processes are the same. The components plot looks as below.</p>
<p><img alt="plot-comp-2" src="../../images/plot_comp_future_reg_2.png" style="height:850px;width:500px" /></p>
<p>There are two individual plots for the additive and multiplicative regressors, where 
the multiplicative component is shown as a percentage. In the same manner, the
coefficients will appear in a plot like below.</p>
<p><img alt="plot-param-2" src="../../images/plot_param_future_reg_2.png" style="height:850px;width:500px" /></p>
<h2 id="regularization-for-future-regressors">Regularization for Future Regressors</h2>
<p>We can add regularization into the future regressors as below. </p>
<pre><code class="language-python">m = m.add_future_regressor(name='A', regularization=0.05)
m = m.add_future_regressor(name='B', regularization=0.02)
</code></pre>
<p>This will add sparsity into the individual regressor coefficients.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../contribute/" class="btn btn-neutral float-right" title="Contribute">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../events/" class="btn btn-neutral" title="Events"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../events/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../contribute/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
